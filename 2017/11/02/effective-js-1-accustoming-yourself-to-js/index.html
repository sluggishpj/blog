<!DOCTYPE html>





<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=7.4.1">
  <link rel="mask-icon" href="/blog/images/logo.svg?v=7.4.1" color="#222">

<link rel="stylesheet" href="/blog/css/main.css?v=7.4.1">


<link rel="stylesheet" href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Muse',
    version: '7.4.1',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":true},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="了解你使用的JavaScript版本1、”use strict”指令只有在脚本或函数的顶部才能生效 2、合并多个不同模式下的js文件时。解决方案：将其自身包裹在立即的函数表达式（IIFE）中的方式连接多个文件。">
<meta property="og:type" content="article">
<meta property="og:title" content="EffectiveJS笔记01之让自己习惯JavaScript">
<meta property="og:url" content="https://sluggishpj.github.io/2017/11/02/effective-js-1-accustoming-yourself-to-js/index.html">
<meta property="og:site_name" content="PJ&#39;S BLOG">
<meta property="og:description" content="了解你使用的JavaScript版本1、”use strict”指令只有在脚本或函数的顶部才能生效 2、合并多个不同模式下的js文件时。解决方案：将其自身包裹在立即的函数表达式（IIFE）中的方式连接多个文件。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.ax1x.com/2019/10/13/uxgfpR.png">
<meta property="article:published_time" content="2017-11-02T23:10:09.000Z">
<meta property="article:modified_time" content="2021-10-11T12:19:35.050Z">
<meta property="article:author" content="PJ">
<meta property="article:tag" content="js">
<meta property="article:tag" content="EffectiveJavaScript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.ax1x.com/2019/10/13/uxgfpR.png">
  <link rel="canonical" href="https://sluggishpj.github.io/2017/11/02/effective-js-1-accustoming-yourself-to-js/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>EffectiveJS笔记01之让自己习惯JavaScript | PJ'S BLOG</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">PJ'S BLOG</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
        
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/blog/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/blog/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/blog/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/blog/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
      
    
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">
        
          <i class="fa fa-search fa-fw"></i>
        
        Search
        </a>
      </li>
    
  </ul>

    

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="https://sluggishpj.github.io/blog/2017/11/02/effective-js-1-accustoming-yourself-to-js/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="PJ">
      <meta itemprop="description" content="B What U Wanna B">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PJ'S BLOG">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            EffectiveJS笔记01之让自己习惯JavaScript
            

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2017-11-02 23:10:09" itemprop="dateCreated datePublished" datetime="2017-11-02T23:10:09+00:00">2017-11-02</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-10-11 12:19:35" itemprop="dateModified" datetime="2021-10-11T12:19:35+00:00">2021-10-11</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/js/EffectiveJS/" itemprop="url" rel="index">
                    <span itemprop="name">EffectiveJS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="了解你使用的JavaScript版本"><a href="#了解你使用的JavaScript版本" class="headerlink" title="了解你使用的JavaScript版本"></a>了解你使用的JavaScript版本</h2><p>1、”use strict”指令只有在脚本或函数的顶部才能生效</p>
<p>2、合并多个不同模式下的js文件时。解决方案：将其自身包裹在立即的函数表达式（IIFE）中的方式连接多个文件。</p>
<a id="more"></a>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// no strict-mode directive</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// file1.js</span></span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// file2.js</span></span><br><span class="line">    <span class="comment">// no strict-mode directive</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>要想构建代码以获得最大的兼容性，最简单的方法是在严格模式下编写代码，并显式地将代码内容包裹在本地启用了严格模式的函数中。</p>
</blockquote>
<h2 id="理解JavaScript的浮点数"><a href="#理解JavaScript的浮点数" class="headerlink" title="理解JavaScript的浮点数"></a>理解JavaScript的浮点数</h2><p>1、JavaScript中的所有数字都是双精度浮点数，都是64位编码数字</p>
<p>2、所有位运算符的工作方式都是相同的。它们将操作数转换为整数，然后使用整数位模式进行运算，最后将结果转换为标准的JavaScript浮点数</p>
<p>3、浮点数运算只能产生近似的结果，四舍五入到最接近的可表示的实数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = (<span class="number">0.1</span> + <span class="number">0.2</span>) + <span class="number">0.3</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="number">0.1</span> + (<span class="number">0.2</span> + <span class="number">0.3</span>);</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// 0.6000000000000001</span></span><br><span class="line"><span class="built_in">console</span>.log(b); <span class="comment">// 0.6</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>对于整数运算，不必担心舍入误差，只需担心计算范围在**-2^(53) ~ 2^(53)**</p>
</blockquote>
<h2 id="担心隐式的强制转换"><a href="#担心隐式的强制转换" class="headerlink" title="担心隐式的强制转换"></a>担心隐式的强制转换</h2><p>1、算术运算符<code>-、*、/</code>和%在计算之前都会尝试将其转换为数字</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'17'</span>*<span class="number">3</span>; <span class="comment">// 51</span></span><br><span class="line"><span class="string">'8'</span>|<span class="string">'1'</span>; <span class="comment">// 9</span></span><br></pre></td></tr></table></figure>

<p>2、标准的库函数也不是很可靠，因为它带有自己的隐式强制转换，会将参数转换为数字（isNaN函数的一个更精确的名称可能是coerecesToNaN）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="built_in">isNaN</span>(<span class="literal">NaN</span>);</span><br><span class="line"><span class="keyword">var</span> b = <span class="built_in">isNaN</span>(<span class="string">'foo'</span>);</span><br><span class="line"><span class="keyword">var</span> c = <span class="built_in">isNaN</span>(<span class="literal">undefined</span>);</span><br><span class="line"><span class="keyword">var</span> d = <span class="built_in">isNaN</span>(&#123;&#125;);</span><br><span class="line"><span class="keyword">var</span> e = <span class="built_in">isNaN</span>(&#123; <span class="attr">valueOf</span>: <span class="string">'foo'</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(b); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(c); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(d); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(e); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>更通用的方法如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isReallyNaN</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x !== x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3、valueOf 与 toString</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">'j'</span> + &#123;</span><br><span class="line">    toString: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'s'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = <span class="number">2</span> * &#123;</span><br><span class="line">    valueOf: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    toString: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'[object MyObject]'</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    valueOf: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">66</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// js</span></span><br><span class="line"><span class="built_in">console</span>.log(b); <span class="comment">// 6</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'object'</span> + obj); <span class="comment">// object66</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>valueOf 方法才是真正为那些代表数值的对象（如Number对象）而设计的。对于这些对象，toString和valueOf方法应返回一致的结果（相同数字的字符串或数值表示），因此，不管是对象的连接还是对象的相加，重载的运算符+总是一致的行为。最好避免使用valueOf方法，除非对象的确是一个数字的抽象，并且obj.toString() 能产生一个obj.valueOf()的字符串表示</p>
</blockquote>
<h2 id="原始类型优于封装对象"><a href="#原始类型优于封装对象" class="headerlink" title="原始类型优于封装对象"></a>原始类型优于封装对象</h2><p>1、不同于原始的字符串，String对象是一个真正的对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">'hello'</span>);</span><br><span class="line"><span class="keyword">var</span> s2 = <span class="string">'world'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> s1); <span class="comment">// object</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> s2); <span class="comment">// string</span></span><br></pre></td></tr></table></figure>

<p>2、每个String对象都是一个单独的对象，其总是只等于自身</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">'hello'</span>);</span><br><span class="line"><span class="keyword">var</span> s2 = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">'hello'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s3 = <span class="string">'hello'</span>;</span><br><span class="line"><span class="keyword">var</span> s4 = <span class="string">'hello'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(s1 == s2); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(s3 === s4); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(s1 == s3); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(s1 === s3); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>3、当对原始值提取属性和进行方法调用时，它表现得就像已经使用了对应的对象类型封装了该值一样，隐式封装</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'hello'</span>.toUpperCase()); <span class="comment">// HELLO</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'hello'</span>;</span><br><span class="line">str.child = <span class="string">'world'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str.child); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>不可以对原始值设置属性，无效。因为每次隐式封装都会产生一个新的String对象，更新第一个封装对象并不会造成持久的影响。</p>
</blockquote>
<h2 id="避免对混合类型使用-运算符"><a href="#避免对混合类型使用-运算符" class="headerlink" title="避免对混合类型使用==运算符"></a>避免对混合类型使用==运算符</h2><p>1、== 运算符的强制转换规则</p>
<table>
<thead>
<tr>
<th align="left">参数类型1</th>
<th align="left">参数类型2</th>
<th align="left">强制转换</th>
</tr>
</thead>
<tbody><tr>
<td align="left">null</td>
<td align="left">undefined</td>
<td align="left">不转换，总是返回true</td>
</tr>
<tr>
<td align="left">null或undefined</td>
<td align="left">其他任何非null或undefined的类型</td>
<td align="left">不转换，总是返回false</td>
</tr>
<tr>
<td align="left">原始类型：string、number或boolean</td>
<td align="left">Date对象</td>
<td align="left">将Date对象转换为原始类型（优先尝试toString方法，再尝试valueOf方法）</td>
</tr>
<tr>
<td align="left">原始类型：string、number或boolean</td>
<td align="left">非Date对象</td>
<td align="left">将非Date对象转换为原始类型（优先尝试valueOf方法，再尝试toString方法）</td>
</tr>
<tr>
<td align="left">原始类型：string、number或boolean</td>
<td align="left">原始类型：string、number或boolean</td>
<td align="left">将原始类型转换为数字</td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2017/11/11'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(date == <span class="string">'2017/11/11'</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(date); <span class="comment">// 2017-11-10T16:00:00.000Z</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>不等是因为Date对象呗转换成一种不同格式的字符串，而不是本例所采用的格式。</p>
</blockquote>
<p>更好的策略是显式自定义应用程序转换的逻辑，并使用严格相等运算符</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toYMD</span>(<span class="params">date</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> y = date.getYear() + <span class="number">1900</span>,</span><br><span class="line">        m = date.getMonth() + <span class="number">1</span>,</span><br><span class="line">        d = date.getDate();</span><br><span class="line">    <span class="keyword">return</span> y + <span class="string">'/'</span> + (m &lt; <span class="number">10</span> ? <span class="string">'0'</span> + m : m) + <span class="string">'/'</span> + (d &lt; <span class="number">10</span> ? <span class="string">'0'</span> + d : d);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2017/11/11'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(toYMD(date) === <span class="string">'2017/11/11'</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>



<h2 id="了解分号插入的局限"><a href="#了解分号插入的局限" class="headerlink" title="了解分号插入的局限"></a>了解分号插入的局限</h2><p>1、5个明确有问题的字符需要密切注意：<code>(、[、+、-</code>和<code>/</code>，每一个字符都能作为一个表达式运算符或者一条语句的前缀。如果下一行以这5个字符之一开始，那么本行不会自动插入分号。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> color = &#123;&#125;</span><br><span class="line"><span class="keyword">var</span> b = <span class="number">3</span></span><br><span class="line"><span class="keyword">var</span> a = b</span><br><span class="line">[<span class="string">'r'</span>,<span class="string">'g'</span>,<span class="string">'b'</span>].forEach(<span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">    color[key] = <span class="number">255</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 报错：</span></span><br><span class="line"><span class="comment">// 'r','g','b'].forEach(function(key) &#123;</span></span><br><span class="line"><span class="comment">//              ^</span></span><br><span class="line"><span class="comment">// TypeError: Cannot read property 'forEach' of undefined</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>原因在于第4行以<code>[</code>开始，因此和第三行一起被解析为一条语句，等价于：</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = b[<span class="string">'r'</span>,<span class="string">'g'</span>,<span class="string">'b'</span>].forEach(<span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">    color[key] = <span class="number">255</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>中括号中是逗号分隔表达式，从左到右一次执行，并返回最后一个表达式的值，对于本例，返回字符”b”</p>
</blockquote>
<p>解决办法：在<code>(、[、+、-</code>和<code>/</code>字符的开始的前一行末尾加分号。最安全的是不要省略分号</p>
<h2 id="视字符串为16位的代码单元序列"><a href="#视字符串为16位的代码单元序列" class="headerlink" title="视字符串为16位的代码单元序列"></a>视字符串为16位的代码单元序列</h2><p>UFT-16的每个代码点编码需要一个或两个16位的代码单元，因此UTF-16是一种可变长度的编码。</p>
<p>JS已经采用16位的字符串元素。字符串属性和方法（如length、chatAt和charCodeAt）都是基于代码单元层级，而不是代码点层级。所以每当字符串包含辅助平面中的代码点时，JS将每个代码点表示为两个代码单元。</p>
<blockquote>
<p>Unicode标准从当时的2^16扩展到了超过2^20个代码点。新增加的范围被组织为17个大小为2^16个代码点。第一个子范围，称为<em>基本多文种平面（Basic Multilingual Plane，BMP）</em>，包含最初的2^16个代码点。余下的16个范围称为 <em>辅助平面（supplementary plane）</em>。</p>
</blockquote>
<p><img src="https://s2.ax1x.com/2019/10/13/uxgfpR.png" alt="一个包含来自辅助平面的代码点的JavaScript字符串"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">'𠮷a'</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="string">'吉a'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a.length); <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">console</span>.log(b.length); <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a.charCodeAt(<span class="number">0</span>)); <span class="comment">// 55362</span></span><br><span class="line"><span class="built_in">console</span>.log(a.charCodeAt(<span class="number">1</span>)); <span class="comment">// 57271</span></span><br><span class="line"><span class="built_in">console</span>.log(a.charCodeAt(<span class="number">2</span>)); <span class="comment">// 97</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a.charAt(<span class="number">1</span>)); <span class="comment">// 乱码</span></span><br><span class="line"><span class="built_in">console</span>.log(a.charAt(<span class="number">2</span>)); <span class="comment">// a</span></span><br><span class="line"><span class="built_in">console</span>.log(b.charAt(<span class="number">1</span>)); <span class="comment">// a</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/^.$/</span>.test(<span class="string">'𠮷'</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="regexp">/^..$/</span>.test(<span class="string">'𠮷'</span>)); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>正则表达式也工作于代码单元层级，其单字符模式（“ . ”）匹配一个单一的代码单元。</p>
<p>上面代码中，汉字<code>𠮷</code>的码点是0x20BB7，UTF-16编码为0xD842 0xDFB7（十进制为55362 57271），需要4个字节储存。</p>
<p>对于这种4个字节的字符，JavaScript不能正确处理，字符串长度会误判为2，而且charAt方法无法读取整个字符，charCodeAt方法只能分别返回前两个字节和后两个字节的值。</p>
</blockquote>
<h2 id="ES6-codePointAt方法"><a href="#ES6-codePointAt方法" class="headerlink" title="ES6 codePointAt方法"></a>ES6 codePointAt方法</h2><p>ES6提供了<strong>codePointAt</strong>方法，能够正确处理4个字节储存的字符，返回一个字符的码点。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">'𠮷a'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(s.codePointAt(<span class="number">0</span>)); <span class="comment">// 134071</span></span><br><span class="line"><span class="built_in">console</span>.log(s.codePointAt(<span class="number">1</span>)); <span class="comment">// 57271</span></span><br><span class="line"><span class="built_in">console</span>.log(s.codePointAt(<span class="number">2</span>)); <span class="comment">// 97</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>JavaScript将“𠮷a”视为三个字符，<code>codePointAt</code>方法在第一个字符上，正确地识别了“𠮷”，返回了它的十进制码点134071（即十六进制的20BB7）。在第二个字符（即“𠮷”的后两个字节）和第三个字符“a”上，<code>codePointAt</code>方法的结果与<code>charCodeAt</code>方法相同。</p>
<p><code>codePointAt</code>方法的参数，仍然是不正确的。比如，上面代码中，字符a在字符串s的正确位置序号应该是1，但是必须向codePointAt方法传入2。解决这个问题的一个办法是使用for…of循环，因为它会正确识别32位的UTF-16字符。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> ch <span class="keyword">of</span> s) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(ch.codePointAt(<span class="number">0</span>).toString(<span class="number">16</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 20bb7</span></span><br><span class="line"><span class="comment">// 61</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以用<code>codePointAt</code>方法是测试一个字符由两个字节还是由四个字节组成</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is32Bit</span>(<span class="params">c</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> c.codePointAt(<span class="number">0</span>) &gt; <span class="number">0xFFFF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(is32Bit(<span class="string">"𠮷"</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(is32Bit(<span class="string">"a"</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>



<h2 id="ES6-fromCodePoint方法"><a href="#ES6-fromCodePoint方法" class="headerlink" title="ES6 fromCodePoint方法"></a>ES6 fromCodePoint方法</h2><p>ES6提供了<strong>String.fromCodePoint</strong>方法，可以识别大于<code>0xFFFF</code>的字符，弥补了<code>String.fromCharCode</code>方法的不足。在作用上，正好与<code>codePointAt</code>方法相反</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">String</span>.fromCodePoint(<span class="number">0x20BB7</span>));</span><br><span class="line"><span class="comment">// "𠮷"</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">String</span>.fromCodePoint(<span class="number">0x78</span>, <span class="number">0x1f680</span>, <span class="number">0x79</span>) === <span class="string">'x\uD83D\uDE80y'</span>);</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考链接：<a href="http://es6.ruanyifeng.com/#docs/string" target="_blank" rel="noopener">http://es6.ruanyifeng.com/#docs/string</a></p>
</blockquote>

    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/blog/tags/js/" rel="tag"># js</a>
            
              <a href="/blog/tags/EffectiveJavaScript/" rel="tag"># EffectiveJavaScript</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/blog/2017/10/30/secrets-of-the-js-ninja-6-prototype-and-oop/" rel="next" title="JavaScript忍者秘籍笔记06之原型与面向对象">
                  <i class="fa fa-chevron-left"></i> JavaScript忍者秘籍笔记06之原型与面向对象
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/blog/2017/11/04/effective-js-2-variable-scope/" rel="prev" title="EffectiveJS笔记02之变量作用域">
                  EffectiveJS笔记02之变量作用域 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    
    <div class="comments" id="gitalk-container"></div>
  

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#了解你使用的JavaScript版本"><span class="nav-number">1.</span> <span class="nav-text">了解你使用的JavaScript版本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#理解JavaScript的浮点数"><span class="nav-number">2.</span> <span class="nav-text">理解JavaScript的浮点数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#担心隐式的强制转换"><span class="nav-number">3.</span> <span class="nav-text">担心隐式的强制转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#原始类型优于封装对象"><span class="nav-number">4.</span> <span class="nav-text">原始类型优于封装对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#避免对混合类型使用-运算符"><span class="nav-number">5.</span> <span class="nav-text">避免对混合类型使用&#x3D;&#x3D;运算符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#了解分号插入的局限"><span class="nav-number">6.</span> <span class="nav-text">了解分号插入的局限</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#视字符串为16位的代码单元序列"><span class="nav-number">7.</span> <span class="nav-text">视字符串为16位的代码单元序列</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ES6-codePointAt方法"><span class="nav-number">8.</span> <span class="nav-text">ES6 codePointAt方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ES6-fromCodePoint方法"><span class="nav-number">9.</span> <span class="nav-text">ES6 fromCodePoint方法</span></a></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">PJ</p>
  <div class="site-description" itemprop="description">B What U Wanna B</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        
          <a href="/blog/archives/%20%7C%7C%20archive">
        
          <span class="site-state-item-count">32</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/blog/categories/%20%7C%7C%20th">
          
        
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">categories</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/blog/tags/%20%7C%7C%20tags">
          
        
        <span class="site-state-item-count">49</span>
        <span class="site-state-item-name">tags</span>
        </a>
      </div>
    
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">PJ</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.1
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">
      
    Theme – <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.4.1
  </div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js?v=3.1.0"></script>
  <script src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

<script src="/blog/js/utils.js?v=7.4.1.js"></script>

<script src="/blog/js/motion.js?v=7.4.1.js"></script>


<script src="/blog/js/schemes/muse.js?v=7.4.1.js"></script>


<script src="/blog/js/next-boot.js?v=7.4.1.js"></script>




  








  
<script src="/blog/js/local-search.js?v=7.4.1.js"></script>















  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: 'dd946c3d0eb6bc5aaf24',
      clientSecret: '5051b237a867f9673700aaef753148bd6fc17d34',
      repo: 'blog',
      owner: 'sluggishpj',
      admin: ['sluggishpj'],
      id: '87b597cfc05d23f1be69ebebd61b396b',
        language: window.navigator.language || window.navigator.userLanguage,
      
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script>

</body>
</html>
